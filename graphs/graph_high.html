<!doctype html>
<html>
	<head>
		<style type="text/css">
			.lower-div {
				margin-top: 20px;
				width: 40%;
				height: 110px;
				border: 1px groove;
				margin-left: 190px;
			}
			.lower-label{
				margin-left: 190px;
			}
			#facebook_videos {
				margin-left: 30px;
				margin-top: 5px;
				width: 200px;
				height: 40px;
			}
			#youtube_videos {
				margin-left: 70px;
				margin-top: 5px;
				width: 200px;	
				height: 40px;

			}
			.success-div {
				margin-top: 20px;
				margin-left: 180px;					
				
				
			}
			.clear {
    			clear: both;
			}
		</style>
		<title>Line Chart</title>
		<h1>Facebook and Youtube Retention</h1>
		<meta charset="utf-8">
  		<meta name="viewport" content="width=device-width, initial-scale=1">
  		<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
  		<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
		<script src="http://code.highcharts.com/highcharts.js"></script>
		<!--script src="http://code.highcharts.com/modules/exporting.js"></script-->

	</head>
	<body>
		<div id="container" style="min-width: 400px; height: 400px; margin: 0 auto"></div>
		<div>
			
			<br>
			<h3 class="lower-label">Paste Facebook and YouTube IDs.</h3>
			<br>
			<div id="lower" class="lower-div">
				<input id="facebook_videos" placeholder="Facebook video id..">
				<input id="youtube_videos" placeholder="YouTube video id..">
				<br>
				<div class="clear"></div>
				<button type="button" class="btn btn-primary success-div" onclick="xxxx();">Success</button>
				<!--button type="submit" onclick="xxxx();">Show Graphs</button-->
			</div>
			
		</div>


	<script>
		//var video_ids = [];
		$(document).ready(function(){
			$.ajax({
				url: "http://localhost:5000/get_video_ids/",
				type: "GET",
				dataType: 'json',
				cache: false,
				success: function(data){
					video_ids = data
					console.log(video_ids)
					$.each(data, function(i, obj){
                    	$('#facebook_videos').append($('<option>').text(obj.video_title).attr('value', obj.video_id));
            		});
				}
			});
		});
		
		var fb_id;
		var yt_id;
		

		function lineHightchart(facebook_values, youtube_values){
			console.log(facebook_values);
			
			$('#container').highcharts({
                title:{
		        	text: "Retention Levels By Channel"
		        },
		        
		        chart: {
		        
		            renderTo: 'container'
		        },
		        xAxis:[
		        	{
		        		type: 'linear'
		        	}
		        ],
		        series: [{
		        	data: youtube_values,
		        	pointStart: 1,
            		pointInterval: 1,
		            name: 'YouTube',
		            color: 'rgb(255,0,0)'
		        },{
		        	data: facebook_values,
		        	pointStart: 0,
            		pointInterval: 100 / facebook_values.length,
		            name: 'Faceook'
		        }]
            });   
		}
		
		function xxxx(){
			fb_id = $("#facebook_videos").val();
			yt_id = $("#youtube_videos").val();
			$.ajax({
				url: "http://localhost:5000/graph_fb/" + fb_id,
				type: "GET",
				cache: false,
				success: function(data){

					data = JSON.parse(data);
					facebook_values = data;		
					console.log(facebook_values)
					$.ajax({
						url: "http://localhost:5000/graph_yt/" + yt_id,
						type: "GET",
						cache: false,
						success: function(data){
							console.log("In youtube_values success")
							data = JSON.parse(data);
							youtube_values = data;
							console.log(youtube_values)
							lineHightchart(facebook_values, youtube_values)
						}
					});
				}
			});
		}

	</script>
  </body>
</html>
